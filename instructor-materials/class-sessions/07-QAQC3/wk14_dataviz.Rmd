---
title: "LAS 6292: DATA VISUALIZATION"
date: "updated: `r Sys.Date()`"
header-includes:
   - \usepackage[default]{sourcesanspro}
   - \usepackage[T1]{fontenc}
mainfont: SourceSansPro
geometry: margin=1in
fontsize: 12pt
linkcolor: blue
urlcolor: blue
output:
  pdf_document: default
  html_document:
    df_print: paged
  rmdformats::robobook: default
---


```{r setup, include=FALSE}
library(knitr)
library(rmdformats)

## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
```

<!-- https://preview.carpentries.org/R-ecology-lesson/ -->
<!-- https://r-graph-gallery.com/218-basic-barplots-with-ggplot2.html -->

## Data Validation

We have previously tried to minimize the number of errors entering, then used OpenRefine to stabndardize different values. Now we are going to try and find errors that managed to sneak into the database.

## Data Validation

Some basics
1. Summary statistics for each variable: Mean, median, mode, range, standard deviations: _look for extreme ranges, unexpected means / SD, etc._ 
1. Frequency distribution for categorical variables, modal value _look at the number in each category...any unusually high or low?_
3. Visualization of individual variables with histograms, box plots, bar charts _how do the distributions of individual variables look?_
4. BUT be aware the means, box plots, histograms, etc. can hide patterns. This is because very different distributions can have very similar means and vars. _provide some examples_
5. Be sure to always plot the raw dataFamous Visualiztion of correlated variables, time series, etc. _for correlated variables, plot the x,y correlation, too_

BUT


Identify outliers: Boxplot, line graph for each case (though it will be messy, can identify an abnormal value easily. Eg, remaining years of life of a human population over age should always be non-increasing, any uphill indicates error (a time-series error)).

Logical check: Scatter plot (or correlation) between known correlated variables. Perform deterministic logical checks, like, if Male then NA for menstrual related questions, or date of birth should not be beyond the date of death, etc.
Outlier	Detection
In numerical data boxplots may help, but you can also look for entries outside what you view as a reasonable span of values (impossible negative or 0 values, age over 100, etc.)
Plot data against time looking for abrupt changes in trend or brief departures from trend.

https://stats.stackexchange.com/questions/481477/how-do-you-spot-errors-in-data

Categorical example
```{r}
x = sample(1:5, 10^4, rep=T)
x[500] = 0; x[600] = 8; x[1000] = 123
table(x)
```

# R code for panel of plots 
```{r}

x1 = rnorm(10^4, 100, 10)
x2 = 3*(x1 - 10)^2
x1[201:220] = rexp(20, 1/100)+100
x1[5001:5010] = 1010:1001
par(mfrow=c(2,2))
 boxplot(x1, main="Boxplot")
 plot(x1, type="l", main="Sequence")
 plot(diff(x1),type="l", main="Differences")
 plot(x1, x2, pch=20, main="Association")
par(mfrow=c(1,1))
```
3. Introduce QC tools
      
    a.	Plotting and Summary Statistics to spot anomalies
    b.  Automated data validation & Annotation
    c.  Verification of random samples from dataset
    d.  Checksums
    http://r-project.ro/conference2018/presentations/presentation_Data_Errors_How_to_Find_Them.pdf
  package validate
  https://cran.r-project.org/web/packages/validate/index.html
  https://cran.r-project.org/web/packages/validate/vignettes/cookbook.html  
    
library(validate)
check_that( data.frame(age=160, driver_license=TRUE),
age >= 0,
age < 150,
if (driver_license == TRUE) age >= 16
)
    
https://www.nature.com/articles/d41586-022-00792-2?WT.ec_id=NATURE-20220324&utm_source=nature_etoc&utm_medium=email&utm_campaign=20220324&sap-outbound-id=B1E43023F70B53ED7657D10BCEA77610176259F8

datasets for visualization 

dog bites by breed: https://www.kaggle.com/datasets/rtatman/animal-bites

calories by cereal: https://www.kaggle.com/datasets/crawford/80-cereals


https://statsandr.com/blog/outliers-detection-in-r/ 

### Data processing Visualization
*  [“Ch7 in Exploratory Data Analysis” in Wickham and Grolemund’s “R for Data Science”:](https://r4ds.had.co.nz/exploratory-data-analysis.html)  
*  Rougier NP, Droettboom M, Bourne PE (2014) Ten Simple Rules for Better Figures. PLoS Comput Biol 10(9): e1003833.



### examples

*  https://viz.wtf/   
*  https://www.youtube.com/watch?v=5Zg-C8AAIGg&amp%3Bfeature=share
*  https://twitter.com/cesifoti/status/1325087429049675778?s=12
*  https://pbs.twimg.com/media/EmOn_HUXEAMHHFY.jpg
*  https://pbs.twimg.com/media/EmOn_HVXEAAKcwC.jpg
*  https://pbs.twimg.com/media/EmOn_HSXcAYH6L-.jpg
*  https://pbs.twimg.com/media/EmJthkyW0AEnztZ.jpg  
*  https://www.lemonde.fr/international/article/2020/11/04/elections-americaines-2020-suivez-la-carte-des-resultats-en-direct_6058394_3210.html
*  https://medium.com/matter/the-trouble-with-the-purple-election-map-31e6cb9f1827
*  [Ugly plots assignment](https://twitter.com/drdrewsteen/status/1172547837046820864?s=12)
*  grammar ofd graphics video: https://vimeo.com/332290655 
*  slides: https://www.yan-holtz.com/PDF/Dataviz_Caveats.pdf



## Pre-Class Preparation (Instructor):  

**Send in an email to students:  **  

  * content of any pre-class emails.

**Bring to Class:  **  

  * Snacks
  * Flip charts and markers
  * Dry write markers
  * Tent cards for student names

## Objectives and Competencies:   

* 
  
## Pre-class Preparation (Students):

### **Readings**

1. [“Ch7 in Exploratory Data Analysis” in Wickham and Grolemund’s “R for Data Science”:](https://r4ds.had.co.nz/exploratory-data-analysis.html)  

2. Rougier NP, Droettboom M, Bourne PE (2014) Ten Simple Rules for Better Figures. PLoS Comput Biol 10(9): e1003833. [read online](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833)



Original Readings for this week: 

1.  Alexander, S.M., Jones, K., Bennett, N.J. et al. Qualitative data sharing and synthesis for sustainability science. Nat Sustain 3, 81–88 (2020).  
        [[read online]](https://doi.org/10.1038/s41893-019-0434-8 )  [[download pdf]](https://github.com/BrunaLab/LAS6292_DataManagement/blob/master/instructor-materials/readings/Alexander_etal_2019_NatureSustainability.pdf)

2. Renaut, S. et al. 2018. Management, Archiving, and Sharing for Biologists and the Role of Research Institutions in the Technology-Oriented Age. *BioScience* 68(6)400–411  
        [[read online]](https://academic.oup.com/bioscience/article/68/6/400/4983937) [[download pdf]](https://github.com/BrunaLab/LAS6292_DataManagement/blob/master/instructor-materials/readings/Renaut_etal_2018_Bioscience.pdf)  

2.  Duke, Clifford S., and John H. Porter. 2013. "The ethics of data sharing and reuse in biology." BioScience 63(6): 483-489.  
        [[read online]](https://academic.oup.com/bioscience/article/63/6/483/226339) [[download pdf]](https://github.com/BrunaLab/LAS6292_DataManagement/blob/master/instructor-materials/readings/Duke%26Porter_2013.pdf)

3.  Tenopir, C., et al.  (2015). Changes in data sharing and data reuse practices and perceptions among scientists worldwide. PloS one, 10(8), e0134826.  
        [[read online]](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0134826) [[download pdf]](https://github.com/BrunaLab/LAS6292_DataManagement/blob/master/instructor-materials/readings/Tenopir_etal_2015.PDF)

4.  Mauthner, NS, & O. Parry O. 2009. Qualitative data preservation and sharing in the social sciences: On whose philosophical terms?. Australian J of Social Issues 44(3):291-307.  
         [[read online]](https://onlinelibrary.wiley.com/doi/abs/10.1002/j.1839-4655.2009.tb00147.x)  [[download pdf]](https://github.com/BrunaLab/LAS6292_DataManagement/blob/master/instructor-materials/readings/Mauthner_et_al-2009-Australian_Journal_of_Social_Issues.pdf)


### **Online Lectures:**  

1. Tommy McCall: [The simple genius of a good graphic](https://www.ted.com/talks/tommy_mccall_the_simple_genius_of_a_good_graphic?language=en)
    
2. R. Luke DuBois: [Insightful human portraits made from data](https://www.ted.com/talks/r_luke_dubois_insightful_human_portraits_made_from_data?language=en)

3. Mike Chapple: [Data Visualization in R with ggplot2](https://www.linkedin.com/learning/data-visualization-in-r-with-ggplot2/the-grammar-of-graphics?resume=false&u=41282748). Watch the "Introducing ggplot2" (4:43) and "Grammar of Graphics" (4:54)


  
## Class Outline
https://datacarpentry.org/R-ecology-lesson/04-visualization-ggplot2.html
for lecture https://www.yan-holtz.com/PDF/Dataviz_Caveats.pdf


```{r timer, echo=FALSE}
t1_overview <- 10
t2_overview <- 10
breakout1 <- 15
breakout1_return <-35
cleaning_demo <-10
snack_break <- 10
proj_overview <- 15
breakout2 <- 45

total_time <- t1_overview + 
  t2_overview + 
  breakout1 + 
  breakout1_return + 
  cleaning_demo +
  snack_break + 
  proj_overview + 
  breakout2 

time_remain <- 180 - total_time
```



