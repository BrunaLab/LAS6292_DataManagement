---
title: "LAS 6292: Reproducibility"
date: "updated: 2023-01-10"
header-includes:
- \AtBeginDocument{\let\maketitle\relax} # this removes default title section
- \usepackage[default]{sourcesanspro}
- \usepackage{fancyhdr} # modify header into left, center, right
- \pagestyle{fancy} # cues the use of fancy headers
- \fancyfoot{} # cues the use of fancy footer
# month & year on header left
- \fancyhead[L]{LAS 6292 Spring 2023, EM Bruna} 
# name and page on header right
- \fancyhead[R]{Reproducibility, p. \thepage} 
- \fancyfoot[R]{Last update 10 January 2023}
# - \usepackage{setspace}{singlespace} # manipulate line spacing 
- \usepackage{parskip} # manipulate indents and spacing before/after paragra phs 
- \usepackage{xcolor} # changes colors of text
# to center to top level (#) headings (my name) and change color of font
# more info # https://www.ctan.org/pkg/sectsty
- \usepackage{sectsty} \sectionfont{\centering\color{darkmidnightblue}}
# to center to sub-sub-headings (###) and change color of font
- \usepackage{sectsty} \subsectionfont{\color{darkmidnightblue}}
# http://latexcolor.com/ to choose colors
# define the colors used above with rgb codes
- \definecolor{darkcerulean}{rgb}{0.03, 0.27, 0.49}
- \definecolor{darkmidnightblue}{rgb}{0.0, 0.2, 0.4}
mainfont: SourceSansPro
geometry: margin=1in
fontsize: 12pt
linkcolor: blue
urlcolor: blue
output:
  pdf_document: default
  # html_document:
  #   df_print: paged
  # rmdformats::robobook: default
---











¶
¶




<p>I always insert some information about the script and what it is for at the top of any .r file</p>
<pre class="r"><code>## script name:
## Author: Emilio Bruna (embruna@ufl.edu)
## Date Created: 2021-02-02
## Date Updated: 2022-01-25
## script description: Some examples of how to use the Tidyverse and BaseR 
## for data clean-up</code></pre>
<p>FIRST THING: STEP AWAY FROM THE COMPUTER
1. Look at data set and make a list of the things you want to change
2. After that, make an outline of how you will do this with code.
There are often multiple ways to do the same thing, so an outline
will help figure out which is best.</p>
<p>For instance:
1. Import table 1
2. Correct column headings in Table 1
3. Import table 2
4. Correct column headings in Table 2
5. bind Table 1 and Table 2 Together</p>
<p>is less efficient than
1. Import table 1
2. Import table 2
3. Bind Table 1 and Table 2 Together
4. Correct the column headings in the Table</p>
<p>BUT there might be situations where you have to do them separately.</p>
<ol start="3" style="list-style-type: decimal">
<li>Reminder: this symbol: # (hash tag) allows comments in the script
that won’t be read as commands</li>
<li>Reminder: Set up a project with folders, put raw data in folders</li>
<li>Create a new .R file</li>
<li>Add key info to the .R file</li>
<li>Add the “Steps” to the .R as Sections with shift-cmd-r (Mac) or shift-alt-r (PC)</li>
<li>the command <code>sessionInfo()</code> will tell you the verison of R you are using,
all the packages you have loaded, and other useful information.</li>
</ol>
<div id="set-up-an-rstudio-project" class="section level1">
<h1>set up an RStudio Project ———————————————–</h1>
<p>Save it in your preferred location with any name you like.
Create new folders: <code>raw_data</code>, <code>clean_data</code>, and <code>r_scripts</code>
You can create these in the folder using your operating systems “create folder” option
OR
you can create within R studio using the <code>files</code> tab</p>
</div>
<div id="installing-packages-using-the-rstudio-packages-tab--" class="section level1">
<h1>Installing packages using the RStudio packages tab ———————-</h1>
<p>Use the tab to install package <code>dadjokeapi</code>
You could also do the following: <code>install.packages("dadjokesapi")</code></p>
<p>this is how you load a library aka ‘package’:</p>
<pre class="r"><code>library(dadjokeapi)</code></pre>
<p>now run this command</p>
<pre class="r"><code>groan()</code></pre>
<pre><code>## I had a pair of racing snails. I removed their shells to make them more aerodynamic, but they became sluggish.</code></pre>
<p>library(tidyverse)</p>
</div>
<div id="load-the-data" class="section level1">
<h1>load the data ———————————————————–</h1>
</div>
<div id="load-the-file-with-read_csv" class="section level1">
<h1>load the file with ‘read_csv’</h1>
</div>
<div id="be-sure-to-point-to-the-right-location-in-your-r-studio-project" class="section level1">
<h1>BE SURE TO POINT TO THE RIGHT LOCATION IN YOUR R STUDIO PROJECT</h1>
</div>
<div id="is-the-root-folder-where-your-.rproj-file-is-located" class="section level1">
<h1>./ is the “root folder” where your .Rproj file is located</h1>
<p>demo &lt;- read_csv(“./class_outlines/wk4_reproducibility/demo_data.csv”)</p>
</div>
<div id="when-we-loaded-the-data-into-r-it-got-stored-as-an-object-of-class-tibble" class="section level1">
<h1>When we loaded the data into R, it got stored as an object of class tibble,</h1>
</div>
<div id="which-is-a-special-kind-of-data-frame.-a-data-frame-is-the-representation-of" class="section level1">
<h1>which is a special kind of data frame. A data frame is the representation of</h1>
</div>
<div id="data-in-the-format-of-a-table-where-the-columns-are-vectors-that-all-have-the" class="section level1">
<h1>data in the format of a table where the columns are vectors that all have the</h1>
</div>
<div id="same-length.-because-columns-are-vectors-each-column-must-contain-a-single" class="section level1">
<h1>same length. Because columns are vectors, each column must contain a single</h1>
</div>
<div id="type-of-data-e.g.-characters-integers-factors." class="section level1">
<h1>type of data (e.g., characters, integers, factors).</h1>
</div>
<div id="overview-of-the-dataframe" class="section level1">
<h1>overview of the dataframe ———————————————–</h1>
</div>
<div id="you-can-see-the-size-of-the-df" class="section level1">
<h1>you can see the size of the df</h1>
</div>
<div id="dimdemo-returns-a-vector-with-the-number-of-rows-in-the-1st-element" class="section level1">
<h1><code>dim(demo)</code> returns a vector with the number of rows in the 1st element,</h1>
</div>
<div id="and-the-number-of-columns-as-the-2nd-element-the-dimensions-of-the-object" class="section level1">
<h1>and the number of columns as the 2nd element (the dimensions of the object)</h1>
<p>dim(demo)</p>
</div>
<div id="nrowdemo---returns-the-number-of-rows" class="section level1">
<h1>nrow(demo) - returns the number of rows</h1>
<p>nrow(demo)</p>
</div>
<div id="ncoldemo---returns-the-number-of-columns" class="section level1">
<h1>ncol(demo) - returns the number of columns</h1>
<p>ncol(demo)</p>
</div>
<div id="look-at-the-top-few-rows-with-head" class="section level1">
<h1>look at the top few rows with ‘head’</h1>
<p>head(demo)</p>
</div>
<div id="open-it-an-look-at-it-with-view-or-2x-click-the-name-in" class="section level1">
<h1>open it an look at it with ‘view’ or 2x click the name in</h1>
<p>view(demo)</p>
</div>
<div id="overview-of-the-data-columns-and-their-data-types-dimensions-etc" class="section level1">
<h1>Overview of the data (columns and their data types, dimensions, etc):</h1>
<p>glimpse(demo)
# or
str(demo)</p>
</div>
<div id="youll-note-the-tidyverse-version-is-usually-easier-to-read" class="section level1">
<h1>You’ll note the <code>tidyverse</code> version is usually easier to read</h1>
</div>
<div id="get-a-list-of-the-column-names" class="section level1">
<h1>get a list of the column names ——————————————</h1>
</div>
<div id="namessurveys---returns-the-column-names" class="section level1">
<h1>names(surveys) - returns the column names</h1>
<p>names(demo)
# colnames() does the same thing for dataframes
colnames(demo)</p>
</div>
<div id="change-data-type-of-a-column-to-factor" class="section level1">
<h1>Change ‘data type’ of a column to <code>factor</code>————————————</h1>
</div>
<div id="as.factor-or-factor" class="section level1">
<h1>as.factor() or factor()</h1>
<p>as.factor(demo<span class="math inline">\(roof) factor(demo\)</span>roof)
# Why didn’t these work? Because you need to assign the change to the variable
# remember &lt;- is the way we say “assign X to Y”, in this case “Assign format
# <code>factor</code> to <code>demo$roof</code>
demo<span class="math inline">\(roof &lt;- as.factor(demo\)</span>roof)</p>
</div>
<div id="change-column-data-types-to-ordered-factor" class="section level1">
<h1>Change column data types to ordered factor</h1>
<p>demo<span class="math inline">\(size as.factor(demo\)</span>size)
ordered(demo<span class="math inline">\(size, levels = c(&quot;small&quot;, &quot;large&quot;)) # same thing...need to assign the change. demo\)</span>size &lt;- ordered(demo<span class="math inline">\(size, levels = c(&quot;small&quot;, &quot;large&quot;)) levels(demo\)</span>size)</p>
</div>
<div id="converting-numbers-from-factor-to-numeric-can-get-complicated" class="section level1">
<h1>converting numbers from factor to numeric can get complicated</h1>
<p>year_fct &lt;- factor(c(1990, 1983, 1977, 1998, 1990))
as.numeric(year_fct) # Wrong! And there is no warning…
as.numeric(as.character(year_fct)) # Works…
as.numeric(levels(year_fct))[year_fct] # Preferred</p>
</div>
<div id="what-is-the-range-of-values-in-a-column" class="section level1">
<h1>what is the range of values in a column? ——————————–</h1>
</div>
<div id="how-long-a-period-does-the-dataset-cover" class="section level1">
<h1>How long a period does the dataset cover?</h1>
<p>range(demo$year)</p>
</div>
<div id="how-to-correct-a-factor-level-e.g.-if-misspelled" class="section level1">
<h1>how to correct a factor level (e.g., if misspelled?) ——————–</h1>
</div>
<div id="what-about-correcting-a-factor-level" class="section level1">
<h1>What about correcting a factor level?</h1>
<p>demo<span class="math inline">\(floor&lt;-as.character(demo\)</span>floor)
demo<span class="math inline">\(floor[demo\)</span>floor==“errth”] &lt;- “earth”
demo<span class="math inline">\(floor&lt;-as.factor(demo\)</span>floor)
levels(demo$floor)</p>
<p>demo<span class="math inline">\(floor&lt;-as.factor(demo\)</span>floor)
levels(demo$floor)</p>
</div>
<div id="or-the-tidyverse-way" class="section level1">
<h1>OR the tidyverse way</h1>
<p>demo<span class="math inline">\(floor&lt;-recode(demo\)</span>floor, earth = “EARTH”)
demo<span class="math inline">\(floor&lt;-recode(demo\)</span>floor, earth = “EARTH”, cement = “CEMENT”)</p>
</div>
<div id="you-can-use-recode-directly-with-factors-it-will-preserve-the-existing" class="section level1">
<h1>You can use recode() directly with factors; it will preserve the existing</h1>
</div>
<div id="order-of-levels-while-changing-the-values.-alternatively-you-can" class="section level1">
<h1>order of levels while changing the values. Alternatively, you can</h1>
</div>
<div id="use-recode_factor-which-will-change-the-order-of-levels-to-match-the" class="section level1">
<h1>use recode_factor() , which will change the order of levels to match the</h1>
</div>
<div id="order-of-replacements." class="section level1">
<h1>order of replacements.</h1>
</div>
<div id="how-many-levels-of-a-factor-are-there--" class="section level1">
<h1>How many levels of a factor are there? ———————————-</h1>
</div>
<div id="r-uses-na-to-represent-missing-values" class="section level1">
<h1>R uses NA to represent missing values</h1>
</div>
<div id="can-do-these-things-the-base-r-way-and-the-tidyverse-way" class="section level1">
<h1>can do these things <code>the Base R way</code> and <code>the tidyverse way</code></h1>
</div>
<div id="how-many-different-roof-types-are-there" class="section level1">
<h1>How many different roof types are there?</h1>
<p>levels(demo<span class="math inline">\(floor) # why null? hadn&#39;t converted yet demo\)</span>floor&lt;-as.factor(demo<span class="math inline">\(floor) levels(demo\)</span>floor)
# the tidyverse way
distinct(demo,floor)</p>
</div>
<div id="how-many-categories-are-there" class="section level1">
<h1>how many categories are there?</h1>
<p>nlevels(demo$floor)
# The tidyverse way. Notice a difference in the output?
distinct(demo,floor) %&gt;% count()</p>
</div>
<div id="how-many-in-each-category" class="section level1">
<h1>How many in each category?</h1>
<p>summary(demo$floor)
# the tidyverse way
demo %&gt;% group_by(floor) %&gt;% summarise(n())</p>
</div>
<div id="how-to-convert-na-to-missing" class="section level1">
<h1>How to convert NA to <code>missing</code> ——————————————</h1>
<p>demo<span class="math inline">\(floor[is.na(demo\)</span>floor)] &lt;- “missing”
# throws error. this is because NA is not a factor right now.
# two approaches. Add ‘missing’ as a factor, then change NAs to missing
# OR
# change to character, replace, and the convert backs
demo<span class="math inline">\(floor&lt;-as.character(demo\)</span>floor)
demo<span class="math inline">\(floor[is.na(demo\)</span>floor)] &lt;- “missing”
demo<span class="math inline">\(floor&lt;-as.factor(demo\)</span>floor)
levels(demo$floor)</p>
</div>
<div id="or-the-tidyverse-way-1" class="section level1">
<h1>OR the tidyverse way</h1>
<p>demo<span class="math inline">\(floor&lt;-fct_explicit_na(demo\)</span>floor, ‘missing’)</p>
</div>
<div id="other-useful-commands" class="section level1">
<h1>other useful commands —————————————————</h1>
</div>
<div id="finally-a-few-others-i-find-very-useful-when-data-cleaning." class="section level1">
<h1>finally, a few others I find very useful when data cleaning.</h1>
</div>
<div id="i-usually-do-these-first-on-all-columns-to-make-life-easier" class="section level1">
<h1>I usually do these first on all columns to make life easier</h1>
</div>
<div id="convert-to-lower-case" class="section level1">
<h1>convert to lower case —————————————————</h1>
<p>demo<span class="math inline">\(floor demo\)</span>floor&lt;-tolower(demo<span class="math inline">\(floor) # note that this converts to character, so have to change back to factor demo\)</span>floor&lt;-as.factor(demo<span class="math inline">\(floor) demo\)</span>floor</p>
</div>
<div id="change-column-names" class="section level1">
<h1>change column names —————————————————–</h1>
</div>
<div id="change-column-name-floor-to-floor_type" class="section level1">
<h1>Change column name <code>floor</code> to <code>floor_type</code></h1>
</div>
<div id="you-could-do-it-by-identifying-the-column-numerically-this-is-base-r" class="section level1">
<h1>you could do it by identifying the column numerically (this is base-R)</h1>
<p>names(demo)
colnames(demo)[4] &lt;- “floor_type1”
names(demo)</p>
</div>
<div id="but-i-dont-recommend-this-because-if-you-change-the-order-of-columns-without" class="section level1">
<h1>BUT I don’t recommend this because if you change the order of columns without</h1>
</div>
<div id="realizing-it-you-will-change-the-name-of-the-wrong-column-use-the" class="section level1">
<h1>realizing it, you will change the name of the wrong column! Use the</h1>
</div>
<div id="tidyverse-way-of-changing-columns." class="section level1">
<h1>tidyverse way of changing columns.</h1>
<p>names(demo)
# dataframe &lt;- rename(dataframe, “new column name” = “old column name”)
demo &lt;- rename(demo, “floor_type”=“floor_type1”)
names(demo)</p>
</div>
<div id="remove-spaces-before-and-after-text--" class="section level1">
<h1>remove spaces before and after text ————————————-</h1>
</div>
<div id="white-space-will-drive-you-crazy-especially-if-around-numbers" class="section level1">
<h1>White space will drive you crazy, especially if around numbers</h1>
</div>
<div id="be-sure-to-point-to-the-right-location-in-your-r-studio-project-1" class="section level1">
<h1>BE SURE TO POINT TO THE RIGHT LOCATION IN YOUR R STUDIO PROJECT</h1>
</div>
<div id="note-i-am-loading-with-read.csv-instead-of-read_csv.-that-is-because-read_csv" class="section level1">
<h1>note I am loading with read.csv instead of read_csv. that is because read_csv()</h1>
</div>
<div id="automatically-strips-away-white-space" class="section level1">
<h1>automatically strips away white space</h1>
<p>demo &lt;- read.csv(“./class_outlines/wk4_reproducibility/demo_data.csv”)
demo<span class="math inline">\(data_collector demo\)</span>data_collector&lt;-trimws(demo$data_collector)
# REMEMBER:
# read_csv trim_ws is default=TRUE
# read.csv trim_ws is default=FALSE</p>
</div>
<div id="save-your-corrected-file-as-a-csv" class="section level1">
<h1>save your corrected file as a csv —————————————</h1>
</div>
<div id="now-save-the-clean-file-as-a-csv" class="section level1">
<h1>Now save the clean file as a csv</h1>
<p>write_csv(demo,“./data_clean/clean_data_20210205”)</p>
</div>
<div id="load-your-clean-file-for-more-analyses--" class="section level1">
<h1>load your clean file for more analyses ———————————-</h1>
</div>
<div id="which-we-can-reload-for-subsequent-analyses" class="section level1">
<h1>Which we can reload for subsequent analyses</h1>
<p>data_clean &lt;- read_csv(“./data_clean/clean_data_20210204”)</p>
</div>
<div id="follow-up-exercises" class="section level1">
<h1>follow-up exercises —————————————————–</h1>
</div>
<div id="take-the-raw_data-find-any-thing-that-needs-to-be-corrected" class="section level1">
<h1>1. Take the raw_data, find any thing that needs to be corrected</h1>
</div>
<div id="spelling-mistakes-etc" class="section level1">
<h1>(spelling mistakes, etc)</h1>
</div>
<div id="convert-any-na-to-missing" class="section level1">
<h1>2. convert any “NA” to “missing”</h1>
</div>
<div id="convert-factor-levels-in-roof-and-wall-to-codes-to-make-easier-to-read" class="section level1">
<h1>3. convert factor levels in ‘roof’ and ‘wall’ to codes to make easier to read</h1>
</div>
<div id="convert-rooms-to-factor-then-back-to-numeric" class="section level1">
<h1>4 convert ‘rooms’ to factor, then back to numeric</h1>
</div>
<div id="save-as-a-csv" class="section level1">
<h1>save as a csv</h1>
</div>
<div id="submit-your-r-code-as-homework-4" class="section level1">
<h1>5 submit your r code as homework 4</h1>
</div>
